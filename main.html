<!DOCTYPE html>
<html>
<head>
    <script type="text/javascript" src="build/app.global.min.js"></script>
</head>
<body>
<script>
    function handleEndMessage(message){
        if (message.name === 'getData'){
            var data = mainApp.data.getFormattedData();
            message.target.page.dispatchMessage('returnData', data);
        } else if (message.name === 'getSettings'){
            //todo
            message.target.page.dispatchMessage('returnSettings', '');
        }
    }

    safari.application.addEventListener("message", handleEndMessage, false);
</script>
</body>
</html>